<!DOCTYPE HTML>
<html lang="es" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Sincronización | Sistemas Operativos 1</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.4.3">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
    
        <link rel="stylesheet" href="../../styles/website.css">
    

        
    
    
    
    <link rel="prev" href="../../book/modulo2/el_despachador.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="2.4" data-basepath="../.." data-revision="Mon Oct 05 2015 22:46:25 GMT-0500 (SA Pacific Standard Time)">
    

<div class="book-summary">
    <div class="book-search" role="search">
        <input type="text" placeholder="Escribe para buscar" class="form-control" />
    </div>
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Introducción
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="book/modulo1/index.html">
            
                
                    <a href="../../book/modulo1/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        Modulo 1: Evolución De Los Sistemas Operativos
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="book/modulo1/generacion_primera_segunda.html">
            
                
                    <a href="../../book/modulo1/generacion_primera_segunda.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Primera Y Segunda Generación
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="book/modulo1/generacion_tercera.html">
            
                
                    <a href="../../book/modulo1/generacion_tercera.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        Tercera Generación
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="book/modulo1/generacion_cuarta.html">
            
                
                    <a href="../../book/modulo1/generacion_cuarta.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        Cuarta Generación
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="book/modulo2/index.html">
            
                
                    <a href="../../book/modulo2/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Modulo 2: El Administrador De Procesos
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="book/modulo2/ejecucion_procesos.html">
            
                
                    <a href="../../book/modulo2/ejecucion_procesos.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Pasos En La Ejecución De Un Proceso
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="book/modulo2/administrador_procesos.html">
            
                
                    <a href="../../book/modulo2/administrador_procesos.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        El Administrador De Procesos
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="book/modulo2/el_despachador.html">
            
                
                    <a href="../../book/modulo2/el_despachador.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        El Despachador
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2.4" data-path="book/modulo2/sincronizacion.html">
            
                
                    <a href="../../book/modulo2/sincronizacion.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Sincronización
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Publicado con GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Tabla de contenido"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Busca"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Configuración de fuente"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">Claro</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sépia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Noche</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Comparte"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Comparte en Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Comparte en Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Comparte en Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Comparte en Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Comparte en Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Sistemas Operativos 1</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="sincronizaci%C3%B3n-de-procesos">Sincronizaci&#xF3;n De Procesos</h1>
<p>Muchos problemas se pueden resolver m&#xE1;s f&#xE1;cilmente o m&#xE1;s eficientemente si
usamos procesos (o hilos) cooperativos, que ejecutan concurrentemente, t&#xE9;cnica
que se conoce como programaci&#xF3;n concurrente. La programaci&#xF3;n concurrente es una
herramienta poderosa, pero introduce algunos problemas que no existen en la
programaci&#xF3;n secuencial no concurrente.<br>Supongamos que usamos dos hilos concurrentes para determinar cuantos n&#xFA;meros
primos hay en in intervalo dado.</p>
<pre><code class="lang-c"><span class="hljs-keyword">int</span> numprimos = <span class="hljs-number">0</span>;
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">primos</span><span class="hljs-params">(<span class="hljs-keyword">int</span> ini, <span class="hljs-keyword">int</span> fin)</span> </span>{
    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = ini; i &lt;= fin; i++)
        <span class="hljs-keyword">if</span> (primo(i)) numprimos++;
}
</code></pre>
<p>Siendo <code>numprimos</code> una variable global, podemos ejecutar <code>primos(1, 5000)</code> en
paralelo con <code>primos(5001, 10000)</code> para saber cuantos n&#xFA;meros primos hay entre
1 y 10000. &#xBF;El problema? <code>numprimos</code> es una variable compartida que se accesa
concurrentemente y puede quedar mal actualizada si se dan determinadas
intercalaciones de las operaciones de los dos hilos. Para ejecutar una
operaci&#xF3;n como <code>numerosprimos++</code> se suelen requerir varias instrucciones de
m&#xE1;quina como por ejemplo.</p>
<pre><code>LOAD numprimos ; cargar el valor en el acumulador
ADD numprimos, 1 ; sumarle 1 al acumulador
STORE numprimos ; escribir el acumulador en memoria
</code></pre><p>Supongamos que m&#xE1;s o menos simult&#xE1;neamente, los dos hilos encuentran su primer
n&#xFA;mero primo. Podr&#xED;a darse el siguiente timing.</p>
<p><img src="../../images/modulo2/problema_sincronizacion_hilos.jpg" alt="Image"></p>
<p>El problema se produce por que los dos hilos o procesos tratan de actualizar
una variable compartida al mismo tiempo, o en otras palabras, un hilo comienza
a actualizar cuando la otra no ha terminado. Eso se conoce como competencia por
datos (data race / race condition), cuando el resultado depende del orden
particular en que se intercalan las operaciones de procesos concurrentes. La
cosa se resuelve si garantizamos que solo un hilo a la vez puede estar
actualizando variable compartidas.</p>
<h2 id="el-problema-de-la-secci%C3%B3n-cr%C3%ADtica">El Problema De La Secci&#xF3;n Cr&#xED;tica</h2>
<p>Modelo: n procesos (P0, P1, P2, ... Pn-1) cada uno de los cuales tiene un trozo
de c&#xF3;digo llamado SECCI&#xD3;N CR&#xCD;TICA, en el que accesa variables o en general
recursos compartidos. El problema de la secci&#xF3;n cr&#xED;tica consiste en encontrar un
mecanismo o protocolo que permita que los procesos cooperen de manera que se
cumpla las siguientes condiciones:</p>
<ul>
<li><strong>Exclusi&#xF3;n Mutua:</strong> La ejecuci&#xF3;n de las respectivas secciones cr&#xED;ticas es
mutuamente exclusiva, es decir nunca hay m&#xE1;s de un procesos ejecutando su
secci&#xF3;n cr&#xED;tica.</li>
<li><strong>Ausencia de Postergaci&#xF3;n Innecesaria:</strong> Si un procesos quiere entrar en su
secci&#xF3;n cr&#xED;tica entonces podr&#xED;a hacerlo si todos los dem&#xE1;s procesos est&#xE1;n
ejecutando sus secciones no cr&#xED;ticas.</li>
<li><strong>Entrada Garantizada (Ausencia de inanici&#xF3;n):</strong> Si un proceso quiere entrar
a la secci&#xF3;n cr&#xED;tica entonces (alg&#xFA;n d&#xED;a) entrar&#xE1;.</li>
</ul>
<p>Podemos pensar que el proceso se ejecuta:</p>
<pre><code class="lang-c"><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
    <span class="hljs-comment">// Protocolo de entrada</span>
        <span class="hljs-comment">// Secci&#xF3;n critica</span>
    <span class="hljs-comment">// Protocolo de salida</span>
        <span class="hljs-comment">// Secci&#xF3;n no critica</span>
}
</code></pre>
<p>Vamos a suponer que:</p>
<ul>
<li>Todos los procesos tienen oportunidad de ejecutar.</li>
<li>Todo proceso que comienza a ejecutarse su secci&#xF3;n cr&#xED;tica, ejecutar&#xE1; en alg&#xFA;n
momento el protocolo de salida.</li>
<li>Las instrucciones b&#xE1;sicas de lenguaje de m&#xE1;quina <code>LOAD, STORE, TEST</code>, se
ejecutan de forma at&#xF3;mica.</li>
</ul>
<p>No debemos hacer ninguna suposici&#xF3;n respecto de la velocidad relativa de
ejecuci&#xF3;n de un proceso con respecto a otro. Por ahora vamos a restringir el
an&#xE1;lisis al caso de dos procesos.</p>
<ul>
<li><strong>PRIMER INTENTO:</strong> Deshabilitar interrupciones.<pre><code class="lang-c"><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-comment">// Deshabilitar interrupciones</span>
      <span class="hljs-comment">// Secci&#xF3;n critica</span>
  <span class="hljs-comment">// Habilitar interrupciones</span>
      <span class="hljs-comment">// Secci&#xF3;n no critica</span>
}
</code></pre>
El problema es dar ese poder a un proceso.</li>
<li><strong>SEGUNDO INTENTO:</strong> Compartir una variable turno que indique quien puede
entrar a la secci&#xF3;n cr&#xED;tica.<pre><code class="lang-c"><span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
  <span class="hljs-keyword">while</span> (turno != <span class="hljs-number">0</span>) { <span class="hljs-comment">// Protocolo de entrada, espero si no es mi turno</span>
      <span class="hljs-comment">// Secci&#xF3;n critica</span>
  }
  turno = <span class="hljs-number">1</span> <span class="hljs-comment">// Cambio de turno</span>
  <span class="hljs-comment">// Secci&#xF3;n no critica</span>
}
</code></pre>
El problema es la Alternaci&#xF3;n estricta, incumple con la Ausencia de
Postergaci&#xF3;n Innecesaria</li>
<li><p><strong>TERCER INTENTO:</strong></p>
</li>
<li><p><strong>CUARTO INTENTO:</strong></p>
</li>
</ul>
<h2 id="sem%C3%A1foros">Sem&#xE1;foros</h2>
<p>Un sem&#xE1;foro es un mecanismo de sincronizaci&#xF3;n que se utiliza generalmente en
sistemas con memoria compartida bien sea monoprocesador o multiprocesador. Un
sem&#xE1;foro es un objeto con valor entero al que se puede asignar un valor inicial
no negativo y al que solo se puede acceder utilizando dos operaciones at&#xF3;micas
<code>wait</code> y <code>signal</code>. Las definiciones de estas operaciones son las siguientes.</p>
<pre><code class="lang-c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">wait</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s)</span> </span>{
    s = s - <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (s &lt; <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// Bloquear proceso</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">signal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s)</span> </span>{
    s = s + <span class="hljs-number">1</span>;
    <span class="hljs-keyword">if</span> (s &lt;= <span class="hljs-number">0</span>) {
        <span class="hljs-comment">// Desbloquear un proceso bloqueado en la operaci&#xF3;n wait</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>Cuando el valor del sem&#xE1;foro es negativo, cualquier operaci&#xF3;n <code>wait</code> que se
realice sobre el sem&#xE1;foro bloquear&#xE1; el proceso. Cuando el valor del sem&#xE1;foro es
positivo, cualquier proceso que ejecute una operaci&#xF3;n <code>wait</code>, no se bloquear&#xE1;.<br>El numero de procesos que en un instante determinado se encuentran bloqueados en
una operaci&#xF3;n <code>wait</code> viene dado por el valor absoluto del sem&#xE1;foro, si es
negativo.<br>Cuando un proceso ejecuta la operaci&#xF3;n <code>signal</code>, el valor del sem&#xE1;foro se
incrementa, en le caso que haya alg&#xFA;n proceso bloqueado en una operaci&#xF3;n <code>wait</code>
anterior, se desbloqueara a un solo proceso.</p>
<h3 id="soluci%C3%B3n-del-problema-de-secci%C3%B3n-critica-para-tres-procesos">Soluci&#xF3;n Del Problema De Secci&#xF3;n Critica Para Tres Procesos</h3>
<p>Para resolver el problema de la secci&#xF3;n cr&#xED;tica, utilizando sem&#xE1;foros debemos
proteger el c&#xF3;digo que constituye la secci&#xF3;n critica de la siguiente forma:</p>
<pre><code class="lang-c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">wait</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s)</span> </span>{
    <span class="hljs-comment">// Secci&#xF3;n cr&#xED;tica</span>
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">signal</span><span class="hljs-params">(<span class="hljs-keyword">int</span> s)</span> </span>{
    <span class="hljs-comment">// Secci&#xF3;n no cr&#xED;tica</span>
}
</code></pre>
<p>El valor que debe tomar el sem&#xE1;foro inicialmente es 1, de esta forma solo se
permite a un &#xFA;nico proceso acceder a la secci&#xF3;n cr&#xED;tica.<br>Si el valor inicial del sem&#xE1;foro fuera por ejemplo 2, entonces dos procesos
podr&#xED;an ejecutar la llamada <code>wait</code> y por lo tanto se permitir&#xED;a que ambos
ejecuten de forma simultanea dentro de la secci&#xF3;n cr&#xED;tica. En la siguiente
figura se muestra la soluci&#xF3;n de este problema para tres procesos. En la
siguiente figura se muestra la soluci&#xF3;n de este problema para tres procesos que
tienen que acceder a su secci&#xF3;n cr&#xED;tica. Los tres procesos se sincronizan
utilizando un sem&#xE1;foro con valor inicial.  </p>
<p><img src="../../images/modulo2/solucion_seccion_criticas_semaforos.jpg" alt="Image"></p>
<h2 id="el-problema-productor-consumidor">El Problema Productor / Consumidor</h2>
<p>Dos procesos que comparten un buffer limitado o circular. En el uso del buffer
compartido el proceso productor fabrica un determinado dato y lo inserta en el
buffer. El proceso consumidor retira del buffer los elementos insertados por el
productor. En este tipo de problemas es necesario evitar que ocurra alguna de
las siguientes situaciones.</p>
<ul>
<li>El consumidor saca elementos cuando el buffer esta vaci&#xF3;.</li>
<li>El productor coloca elementos en el buffer cuando este se encuentra lleno.</li>
<li>El productor sobrescribe un elemento que todav&#xED;a no ha sido sacado del buffer.</li>
<li>El consumidor saca elementos del buffer que ya fueron sacados con
anterioridad.</li>
<li>El consumidor saca un elemento mientras el productor lo est&#xE1; insertando.</li>
</ul>
<p><img src="../../images/modulo2/problema_productor_consumidor.jpg" alt="Image"></p>
<pre><code class="lang-c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">productor</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> posicion = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        producir_un_dato;
        wait(huecos);  <span class="hljs-comment">// Decrementa huecos</span>
        buffer[posicion] = dato;  <span class="hljs-comment">// Se inserta en el buffer</span>
        posicion = (posicion + <span class="hljs-number">1</span>) % BUFFER_SIZE;
        signal(elementos);  <span class="hljs-comment">// Incrementa elementos</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">consumidor</span><span class="hljs-params">()</span> </span>{
    <span class="hljs-keyword">int</span> posicion = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">while</span> (<span class="hljs-literal">true</span>) {
        producir_un_dato;
        wait(elementos);  <span class="hljs-comment">// Decrementa elementos</span>
        dato = buffer[posicion];  <span class="hljs-comment">// Extrae del buffer</span>
        posicion = (posicion + <span class="hljs-number">1</span>) % BUFFER_SIZE;
        signal(huecos);  <span class="hljs-comment">// Incrementa huecos</span>
        <span class="hljs-comment">// Consumir dato extra&#xED;do</span>
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p>El sem&#xE1;foro <code>huecos</code> representa el numero de ranuras libres que hay en el buffer
y el sem&#xE1;foro <code>elementos</code> el n&#xFA;mero de elementos introducidos en el buffer por
el productor que aun no han sido retirados por el consumidor.<br>Cuando el productor desea introducir un nuevo elemento en el buffer decrementa
el valor del sem&#xE1;foro <code>huecos</code> (operaci&#xF3;n <code>wait</code>). Si el valor se hace negativo,
el proceso se bloquea ya que no hay nuevos huecos donde insertar elementos.
Cuando el productor ha insertado un nuevo dato en el buffer incrementa el valor
del sem&#xE1;foro <code>elementos</code> (operaci&#xF3;n <code>signal</code>). Por su parte el proceso
consumidor antes de eliminar del buffer un elemento decrementa el valor del
sem&#xE1;foro <code>elementos</code> (operaci&#xF3;n <code>wait</code>). Si el valor se hace negativo, el
proceso se bloquea. Cuando elimina del buffer un elemento incrementa el valor
del sem&#xE1;foro <code>huecos</code> (operaci&#xF3;n <code>signal</code>). La correcta sincronizaci&#xF3;n entre los
dos procesos queda asegurada puesto que cuando el proceso consumidor en la
operaci&#xF3;n <code>wait</code> sobre el sem&#xE1;foro <code>elementos</code> se despertar&#xE1; cuando el proceso
productor inserte un nuevo elemento en el buffer e incremente el valor de dicho
sem&#xE1;foro con la operaci&#xF3;n <code>signal</code>. De igual manera cuando el proceso productor
se bloquea por que el buffer esta vac&#xED;o se despertar&#xE1; cuando el proceso
consumidor extraiga un elemento e incremente el valor del sem&#xE1;foro <code>huecos</code>.</p>
<h2 id="el-problema-lectores-escritores">El Problema Lectores / Escritores</h2>
<pre><code class="lang-c"><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">lector</span><span class="hljs-params">()</span> </span>{
    n_lectores++;
    <span class="hljs-keyword">if</span> (n_lectores == <span class="hljs-number">1</span>) {
        wait(sem_recurso);
    }
    signal(sem_lectura);
    <span class="hljs-comment">// Consultar recurso compartido</span>
    wait(sem_lectura);
    n_lectores--;
    <span class="hljs-keyword">if</span> (n_lectores == <span class="hljs-number">0</span>) {
        signal(sem_recurso);
    }
    signal(sem_lectores)
}

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">escritor</span><span class="hljs-params">()</span> </span>{
    wait(sem_recurso);
    <span class="hljs-comment">// Se puede modificar el recurso</span>
    signal(sem_recurso);
}
</code></pre>
<p>En esta soluci&#xF3;n, el sem&#xE1;foro <code>sem_recurso</code> se utiliza para asegurar la
exclusi&#xF3;n mutua en el acceso al dato a compartir. Su valor inicial debe ser 1,
de esta manera en cuanto un escritor consigue decrementar su valor puede
modificar el dato y evitar que ning&#xFA;n otro proceso, ni lector ni escritor acceda
al recurso compartido.<br>La variable <code>n_lectores</code> se utiliza para representar el n&#xFA;mero de procesos
lectores que se encuentran accediendo de forma simult&#xE1;nea al recurso compartido.
A esta variable acceden los procesos lectores en exclusi&#xF3;n mutua utilizando el
sem&#xE1;foro <code>sem_lectores</code>. El valor de este sem&#xE1;foro, como el del cualquier otro
que se quiera emplear para acceder en exclusi&#xF3;n mutua a un fragmento de c&#xF3;digo
debe ser 1. De esta forma se consigue que s&#xF3;lo un proceso lector modifique el
valor de la variable <code>n_lectores</code>.<br>El primer proceso lector ser&#xE1; el encargado de solicitar el acceso al recurso
compartido decrementando el valor del sem&#xE1;foro <code>sem_recurso</code> mediante la
operaci&#xF3;n <code>wait</code>. El resto de procesos lectores que quieran acceder mientras
est&#xE9; el primero podr&#xE1;n hacerlo sin necesidad de solicitar el acceso al recurso
compartido. Cuando el ultimo proceso lector abandona la secci&#xF3;n de c&#xF3;digo que
permite acceder al recurso compartido <code>n_lectores</code> se hace 0. En este caso
deber&#xE1; incrementar el valor del sem&#xE1;foro <code>sem_recurso</code> para permitir que
cualquier proceso escritor pueda acceder para modificar el recurso compartido.<br>Esta soluci&#xF3;n, tal y como se ha descrito, permite resolver el problema de los
lectores/escritores pero concede prioridad a los procesos lectores. Siempre que
haya un proceso lector, consultando el valor del recurso, cualquier proceso
lector podr&#xE1; acceder sin necesidad de solicitar el acceso. Sin embargo, los
procesos escritores deber&#xE1;n esperar hasta que haya abandonado la consulta el
ultimo lector. Existen soluciones que permiten dar prioridad a los escritores,
soluciones que se dejan al lector.</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../book/modulo2/el_despachador.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: El Despachador"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
